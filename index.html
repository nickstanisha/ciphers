<!DOCTYPE html>
<html>
<head>
	<title>Popular Cipher Decoder</title>
	<meta charset="UTF-8">
</head>
<body>
<link rel="stylesheet" href="https://raw.githubusercontent.com/nickstanisha/nickstanisha.github.io/master/css/bootstrap.min.css">
<link rel="stylesheet" href="css/style.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="https://raw.githubusercontent.com/nickstanisha/nickstanisha.github.io/master/js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/caesar.js"></script>
<script type="text/javascript" src="js/vigenere.js"></script>
<script type="text/javascript" src="js/provenzano.js"></script>
<script type="text/javascript">
	function isLetter(num) {
		return ((num >= 97 && num <=122) || (num >= 65 && num <= 90))
	}

	var key_req = {'caesar': 'numeric',
					'vigenere': 'alphabet',
					'provenzano': 'numeric'};

	function valid_key(cipher, key) {
		if (key_req[cipher] == "numeric") {
			return (!isNaN(+key) && +key >= 0);
		} else if (key_req[cipher] == 'alphabet') {
			var RegExpression = /^[a-zA-Z]*$/;
			return RegExpression.test(key.replace(/\s+/g, ''));
		}
	};

	var description = {'caesar': "One of the simplest and earliest known ciphers, the Caesar cipher is \
								created by shifting all letters in a message by a fixed amount. \
								This amount is the cipher's key. For a key of 1, A is replaced by B, B by C, \
								etc. until Z is replaced with A. The Caesar cipher is considered weak because, \
								even without knowledge of the key, the original message can be determined by \
								examining the frequency of the letters that appear in the message. The Caesar cipher was \
								named after Julius Ceasar who encrypted military messages using 3 as his key.",
						'vigenere' : 'A Vigen&egrave;re cipher is like a bunch of Caesar ciphers put together. Unlike \
									the Caesar cipher, a Vigen&egrave;re cipher\'s keyword is a passphrase. Each letter \
									in the message is translated according to the position in the alphabet of the \
									corresponding letter in the passphrase (looping back to the beginning if the message \
									is longer than the passphrase).  A Vigen&egrave;re cipher using the key "abcd" would \
									keep the first letter the same, shift the second letter by one, the third by two, and \
									the fourth by three before looping and keeping the fifth letter the same. During the US \
									Civil War, the Confederate states communicated using Vigen&egrave;re ciphers with the \
									passphrases "Manchester Bluff", "Complete Victory" and "Come Retribution".<br>A \
									Vigen&egrave;re cipher is much harder to crack than a Caesar cipher-- in fact, if the \
									key used is longer than the message, frequency analysis (which can be used to break the \
									Caesar cipher) becomes impossible. <a href="https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher#Cryptanalysis">A series of more sophisticated methods</a> \
									must be used to crack the Vigen&egrave;re cipher reliably.',
						'provenzano' : 'Infamously used by Mafia boss Bernardo Provenzano, this cipher is a simple \
										variation on a Caesar cipher where, instead of translating each letter to a new \
										letter in the alphabet, the letters are first translated to numbers representing \
										their position in the alphabet, and those numbers are incremented by the key. \
										Provenzano used the key "4" to translate every "A" in his messages to the number \
										"4", "B" to "5" etc. Because Caesar ciphers are \
										<a href="https://en.wikipedia.org/wiki/Caesar_cipher#Breaking_the_cipher">easy to break</a> \
										by frequency analysis or plain old guessing, Bernardo Provenzano was captured in Sicily \
										in 2006.'};

	$(document).ready(function(){
		var selected = $("#cipher-options").val();
		$("#description").html(description[selected]);

		$("#cipher-options").change(function() {
			var selected = $("#cipher-options").val();
			$("#description").html(description[selected]);
		});

		$("#encode").click(function(){
			var selected = $("#cipher-options").val();
			var key = $("#cipher_key").val();
			if (key == "") {
				$("#error_msg").text("A valid cipher key must be provided!");
			} else if (!valid_key(selected, key)) {
				if (key_req[selected] == 'numeric') {
					$("#error_msg").text("Current cipher requires a positive numeric key.");
				} else if (key_req[selected] == 'alphabet') {
					$("#error_msg").text("Current cipher requires a key containing only letters.");
				}
			} else {
				$("#error_msg").text("");
				if ($("#decoded_box").val() !== "") {
					var message = $("#decoded_box").val()
					switch ($("#cipher-options").val()) {
						case 'caesar':
							$("#encoded_box").val(encode_caesar(message, key));
							$("#decoded_box").val("");
							break;

						case 'vigenere':
							$("#encoded_box").val(encode_vigenere(message, key.replace(/\s+/g, '')));
							$("#decoded_box").val("");
							break;

						case 'provenzano':
							$("#encoded_box").val(encode_provenzano(message, key));
							$("#decoded_box").val("");
							break;
					}
				}
			}
		});

		$("#decode").click(function() {
			var selected = $("#cipher-options").val();
			var key = $("#cipher_key").val();
			if (key == "") {
				$("#error_msg").text("A valid cipher key must be provided!");
			} else if (!valid_key(selected, key)) {
				if (key_req[selected] == 'numeric') {
					$("#error_msg").text("Current cipher requires a positive numeric key.");
				} else if (key_req[selected] == 'alphabet') {
					$("#error_msg").text("Current cipher requires a key containing only letters.");
				}
			} else {
				$("#error_msg").text("");
				if ($("#encoded_box").val() !== "") {
					var message = $("#encoded_box").val();
					switch ($("#cipher-options").val()) {
						case 'caesar':
							$("#decoded_box").val(decode_caesar(message, key));
							$("#encoded_box").val("");
							break;

						case 'vigenere':
							$("#decoded_box").val(decode_vigenere(message, key.replace(/\s+/g, '')));
							$("#encoded_box").val("");
							break;

						case 'provenzano':
							$("#decoded_box").val(decode_provenzano(message, key));
							$("#encoded_box").val("");
							break;
					}
				}
			}
		});
	});
</script>

<div class="container">
	<div class="row">
		<div class="col-sm-6" style="tex-align: left; float: left">
			<h4>
				<a href="http://nickstanisha.github.io" style="color: #ECECEA">Home</a>
			</h4>
		</div>
		<div class="col-sm-6" style="text-align: right; float: right">
			<h4>
				<a href="https://github.com/nickstanisha/ciphers" style="color: #ECECEA">code</a>
				<a href="http://www.twitter.com/sticknanisha" style="color: #ECECEA">twitter</a>
			</h4>
		</div>
	</div>
	<div class="row">
   		<div class="col-sm-6">
   			<h3 style="margin-bottom: 2px; margin-top: 5px; color: #ECECEA">Ciphers</h3>
   		</div>
   		<div class="col-sm-3">
   			<select id="cipher-options" style="margin-top: 17px; float: left;">
  				<option value="caesar">Caesar</option>
  				<option value="vigenere">Vigen&egrave;re</option>
  				<option value="provenzano">Provenzano</option>
			</select> 
   		</div>
   		<div class="col-sm-3">
   			<input type="text" id="cipher_key" style="width: 120px; float: right; margin-top: 12px" placeholder="Cipher key"></input>
   		</div>

   	</div>
   	<div class="row">
		<div class="col-sm-6">
			<textarea rows="10" overflow="scroll" id="decoded_box" style="width: 100%;" placeholder="Unencoded message"></textarea>
		</div>
		<div class="col-sm-6">
			<textarea rows="10" overflow="scroll" id="encoded_box" style="width: 100%;" placeholder="Encoded message"></textarea>
		</div>
	</div>
	<div class="row">
		<div class="col-sm-6">
			<button type="button" class="btn btn-primary-outline" id="encode" style="margin-top: 3px">Encode</button>
		</div>
		<div class="col-sm-6">
			<button type="button" class="btn btn-primary-outline" id="decode" style="margin-top: 3px">Decode</button>
		</div>
	</div>
	<div class="row" style="color: #ECECEA; text-align: center;">
		<p><i id="error_msg" style="font-size: 14pt"></i></p>
	</div>
	<hr>
	<div class="row">
		<p id="description" style="font-size: 12pt; color: #ECECEA; margin-left: 15px; margin-right: 15px;"></p>
	</div>
</div>

<footer class="footer navbar-fixed-bottom" style="background-color: #558C89;">
	<div class="container">
		<div class="col-sm-6" style="tex-align: left; float: left">
			<p href="http://nickstanisha.github.io" style="color: #ECECEA">Nick Stanisha</p>
		</div>
		<div class="col-sm-6" style="text-align: right; float: right">
			<a href="https://opensource.org/licenses/MIT" style="color: #ECECEA">MIT License</a>
		</div>
	</div>
</footer>
</body>
</html>
